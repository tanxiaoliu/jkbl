<!DOCTYPE html>
<html>
<head>
    <tc_include file="Public:head" />
    <link rel="stylesheet" href="__TMPL__Public/assets/css/shop.css">
    <link rel="stylesheet" href="__TMPL__Public/assets/css/style.css">

</head>
<body style="overflow: auto">

<div>
      <div id="loginmodal" style="margin:0 auto;margin-top:3rem; " >
      <!-- <div id="loginmodal" style="display:none;"> -->

        <form id="loginform" name="loginform" method="post" action="{:U('Invite')}" onsubmit="return check(this)">
          <input type="hidden" name="url" id="url" value="{:U('Invite')}">
          <label for="code">请输入邀请码:</label>
          <input type="text" name="code" id="code" class="txtfield" tabindex="1">
          <div class="center"><input type="submit" name="loginbtn" id="loginbtn" class="flatbtn-blu hidemodal" value="提交" tabindex="3"></div>

        </form>

      </div>
</div>
    <tc_include file="Public:scripts" />

<script>
    $(function(){
        // $('#modaltrigger').leanModal({ top: 110, overlay: 0.45, closeButton: ".hidemodal" });
        $('.modaltrigger').leanModal({ top: 110, overlay: 0.45});
        $(".flatbtn").each(function(i){
             $(this).click(function(){
                $("#goodid").val($(this).parent().prev().val())
              })
          });
        $(".gongyi").each(function(i){
             $(this).click(function(){
                  if (confirm("确认要捐赠公益吗")) {
                       $("#goodid").val($(this).parent().prev().val())
                       var url = $("#url").val();
                       $.post(url,$("#loginform").serialize(),function(data){
      /*                    console.log($("#loginform").serialize())
                          console.log(data)*/
                          if (data.status==1&&data.state=='success') {
                              alert(data.info)
                              window.location.href=data.url; 
                          }else{
                              alert(data.info)
                          }
                        },
                        "json");//这里返回的类型有：json,html,xml,text
                 }else{
                      return;
                 }
              })
          });

         $(".top ul li").click(function(){
            $(this).addClass("white").siblings().removeClass("white");
        });


    });
     function check(form) {
          if(form.code.value=='') {
                alert("请输入邀请码!");
                form.username.focus();
                return false;
           }
           if (confirm("请确认信息后下单")) {
                 var url = $("#url").val();;
                 $.post(url,$("#loginform").serialize(),function(data){
/*                    console.log($("#loginform").serialize())
                    console.log(data)*/
                    if (data.status==1&&data.state=='success') {
                        alert(data.info)
                        window.location.href=data.url; 
                    }else{
                        alert(data.info)
                    }
                  },
                  "json");//这里返回的类型有：json,html,xml,text
                return false;
           }else{
                return false;
           }
         }
</script>
<script src="__TMPL__Public/assets/js/jquery-1.9.1.min.js"></script>
<script src="__TMPL__Public/assets/js/jquery.leanModal.min.js"></script>

</body>
</html>