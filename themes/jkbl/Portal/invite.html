<!DOCTYPE html>
<html>
<head>
    <tc_include file="Public:head" />
    <link rel="stylesheet" href="__TMPL__Public/assets/css/shop.css">
    <link rel="stylesheet" href="__TMPL__Public/assets/css/style.css">

</head>
<body style="overflow: auto">

<div>
      <div id="loginmodal" style="margin:0 auto;margin-top:3rem; " >
      <!-- <div id="loginmodal" style="display:none;"> -->

        <form id="loginform" name="loginform" method="post" action="{:U('Invite')}" onsubmit="return check(this)">
          <input type="text" name="url" id="url" value="{:U('Invite')}" style="display: none;">
          <label for="code">请输入邀请码:</label>
          <input type="text" name="code" id="code" class="txtfield" tabindex="1">
          <div class="center"><input type="submit" name="loginbtn" id="loginbtn" class="flatbtn-blu hidemodal" value="提交" tabindex="3"></div>

        </form>

      </div>
</div>
    <tc_include file="Public:scripts" />

<script>
    $(function(){
        // $('#modaltrigger').leanModal({ top: 110, overlay: 0.45, closeButton: ".hidemodal" });
        $('.modaltrigger').leanModal({ top: 110, overlay: 0.45});
       
         $(".top ul li").click(function(){
            $(this).addClass("white").siblings().removeClass("white");
        });


    });
    function tishi(content,url) {
      var html = '<div class="xiaoxi none" id="msg" style="z-index:11001;left: 5%;width: 90%;position: fixed;background:none;top:50%;"> <p class="msg" style="background: none repeat scroll 0 0 #000; border-radius: 30px;color: #fff; margin: 0 auto;padding: 1.5em;text-align: center;width: 70%;opacity: 0.8;"></p></div>';
      $(document.body).append(html); 
      $("#msg").show();
      $(".msg").html(content);
      if(url){
      window.setTimeout("location.href='"+url+"'", 1500);
      }else{
      setTimeout('$(".msg").fadeOut()', 1500);
      }
    } 
     function check(form) {
          if(form.code.value=='') {
                tishi('请输入邀请码');
                form.username.focus();
                return false;
           }
           var url = $("#url").val();;
           $.post(url,$("#loginform").serialize(),function(data){
/*                    console.log($("#loginform").serialize())
              console.log(data)*/
              if (data.status==1&&data.state=='success') {
                  tishi(data.info,data.url);
              }else{
                  tishi(data.info);
              }
            },
            "json");//这里返回的类型有：json,html,xml,text
          return false;
         }
</script>
<script src="__TMPL__Public/assets/js/jquery-1.9.1.min.js"></script>
<script src="__TMPL__Public/assets/js/jquery.leanModal.min.js"></script>

</body>
</html>