<!DOCTYPE html>
<html>
<head>
    <tc_include file="Public:head" />
</head>
<body style="overflow: auto">

<div>
    <tc_include file="Public:nav1" />
    <div class="m-content">
        <p class="ggz"><img src="__TMPL__Public/assets/images/gg.png"></p>
        <div class="m-content-nav">
            <div class="m-title"><img src="__TMPL__Public/assets/images/caidai.png"></div>
            <div class="m-count">成员总计：{$sum} 步<a class="detail-btn flatbtn modaltrigger" href="#loginmodal"  style="position: relative;left: 2rem;bottom: 0.2rem;">详情</a></div>
        </div>
        <input id="data" type="hidden" value="{$data}">
        <input id="status" type="hidden" value="{$status}">
        <div id="main" style="height:12rem; margin-top: -2.5rem;"></div>
        <div class="m-type" style="margin-top: 4rem;">{$type}</div>
    </div>
    <tc_include file="Public:footer" />
    <div id="loginmodal" style="display:none;">
        <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/member', array('type'=>1))}"><input type="button" class="flatbtn-blu hidemodal" value="昨日记录"></a></div>
        <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/member', array('type'=>2))}"><input type="button" class="flatbtn-blu hidemodal" value="上周记录"></a></div>
        <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/member', array('type'=>3))}"><input type="button" class="flatbtn-blu hidemodal" value="上月记录"></a></div>
        <form id="loginform" name="loginform" method="post" action="{:U('Index/member')}" onsubmit="return check(this)">
            <input type="hidden" name="type" id="type" value="4">
            <input type="hidden" value="{$grouptype}">
            <div class="center" style="color: #18abe1;">选择时间段</div>
            <div class="center" style="margin: 0.5rem 0;padding-right: 2rem;width: 13rem;"><span style="color: #18abe1;">结束时间：</span><span><input type="date" name="startTime" id="startTime" style="height: 1rem;"></span></div>
            <div class="center" style="margin: 0.5rem 0;padding-right: 2rem;width: 13rem;"><span style="color: #18abe1;">开始时间：</span><span><input type="date" name="endTime" id="endTime" style="height: 1rem;"></span></div>
            <div class="center" style="margin: 0.5rem 0;"><input type="submit" class="flatbtn-blu hidemodal" value="搜索">
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="button" class="flatbtn-blu close" value="取消"/></div>
        </form>
    </div>
</div>
<script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
<script src="__TMPL__Public/assets/js/jquery-1.9.1.min.js"></script>
<script src="__TMPL__Public/assets/js/jquery.leanModal.min.js"></script>
<script>
    $(function(){
        $('.modaltrigger').leanModal({ top: 110, overlay: 0.45});
        document.getElementById('startTime').valueAsDate = new Date();
        document.getElementById('endTime').valueAsDate = new Date();
        $(".flatbtn").each(function(i){
            $(this).click(function(){
                $("#goodid").val($(this).parent().prev().val())
            })
        });
        $(".rank-top ul li").click(function(){
            $(this).addClass("blue").siblings().removeClass("blue");
        });
        $('.close').click(function(){
            $(this).parents("#loginmodal").hide();
            $("#lean_overlay").css('display','none');
        });
    });
     function check(form) {
        if(form.startTime.value=='') {
            alert("请输入开始时间!");
            form.startTime.focus();
            return false;
        }
        if(form.endTime.value=='') {
            alert("请输入结束时间!");
            form.endTime.focus();
            return false;
        }
        if(form.startTime.value > form.endTime.value){
            alert("开始时间不能结束时间!");
            form.endTime.focus();
            return false;
        }
    }
</script>
<script type="text/javascript">
    // var data1 = $("#data1").val();
    // data1 = eval(data1);
    var data = $("#data").val();
    var status = $("#status").val();
    console.log(status);
    if (status=="0") {
        data = eval("[{value:1, name:'暂无分组'}]");
    }
    if (status=="1"&&data=="[]") {
        data = eval("[{value:1, name:'暂无记录'}]");
    }
    if (status=="1"&&data.length>2) {
        data = eval(data);
    }
    var theme = {
        // 默认色板
        color: [
            '#2ec7c9','#b6a2de','#5ab1ef','#ffb980','#d87a80',
            '#8d98b3','#e5cf0d','#97b552','#95706d','#dc69aa',
            '#07a2a4','#9a7fd1','#588dd5','#f5994e','#c05050',
            '#59678c','#c9ab00','#7eb00a','#6f5553','#c14089'
        ]
    };

    require.config({
        paths: {
            echarts: 'http://echarts.baidu.com/build/dist'
        }
    });
    require(
            [
                'echarts',
                'echarts/chart/pie'  // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
            ],
            function (ec) {
                var myChart = ec.init(document.getElementById('main'), theme);
                var option = {
//                    title : {
//                        text: '某站点用户访问来源',
//                        subtext: '纯属虚构',
//                        x:'center'
//                    },
                    tooltip : {
                        trigger: 'item',
//                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                    },
                    legend: {
                        orient: 'vertical',
                        bottom: 'bottom',
                        // data: ['直接访问','邮件营销','联盟广告','视频广告','搜索引擎','视频广告1','视频广告2','视频广告3']
                        data: []
                    },
                    color: [
                        '#2ec7c9','#b6a2de','#5ab1ef','#ffb980','#d87a80',
                        '#8d98b3','#e5cf0d','#97b552','#95706d','#dc69aa',
                        '#07a2a4','#9a7fd1','#588dd5','#f5994e','#c05050',
                        '#59678c','#c9ab00','#7eb00a','#6f5553','#c14089'
                    ],
                    series : [
                        {
                            name: '成员贡献表',
                            type: 'pie',
                            radius : '55%',
                            center: ['50%', '60%'],
                            // data:[
                            //     arrays
                            // ],
                            data:[
                                /*{value:1, name:'直接访问'},
                                {value:1, name:'邮件营销'},
                                {value:1, name:'联盟广告'},
                                {value:1, name:'视频广告'},
                                {value:1, name:'视频广告1'},
                                {value:1, name:'视频广告2'},
                                {value:1, name:'视频广告3'},
                                {value:1, name:'搜索引擎'}*/
                            ],
                            itemStyle: {
                                emphasis: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        }
                    ]
                };
                for (var i = data.length - 1; i >= 0; i--) {
                    option.series[0].data.push(data[i])
                }
                // console.log(option.series[0].data)
                myChart.setOption(option);
            }
    );
</script>
</body>
</html>