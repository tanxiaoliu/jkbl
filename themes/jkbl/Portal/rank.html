<!DOCTYPE html>
<html>
<head>
    <tc_include file="Public:head" />
    <link rel="stylesheet" href="__TMPL__Public/assets/css/index.css">
</head>
<body style="overflow: hidden;">

<div>
    <tc_include file="Public:nav1" />
    <div class="rank-content-nav">
        <ul>
            <li class="<if condition="$grouptype eq 0">gray_rank</if>"><a href="{:U('Index/rank')}">个人排名</a></li>
            <li class="<if condition="$grouptype eq 1">gray_rank</if>"><a href="{:U('Index/rank', array('grouptype'=>1))}">联盟排名</a></li>
        </ul>
    </div>
    <br/>
    <div class="content">
        <if condition="$status != 1 && $grouptype == 1">
        <span style="text-align: center; color: #18abe1;position: relative;top: 0.5rem;left: 3.6rem;">点击组头像可查看组成员</span><a class="detail-btn flatbtn modaltrigger" href="#loginmodal" style="position: relative;top: 0.5rem;left: 4.6rem;">详情</a>
            <p class="type-title">{$type}</p>
            <else />
        <a class="detail-btn flatbtn modaltrigger" href="#loginmodal" style="position: relative;top: 0.5rem;left: 81.5%;">详情</a>
            <p class="type-title" style="top: -0.3rem;">{$type}</p>
        </if>
            <div class="rank1" style="margin-top: 0.5rem;">
            <div style="width:100%; height:10rem;  overflow-x: hidden; overflow-y: auto; font-size: 0.45rem;">
                <volist name="data" id="vo" offset="0" length='500'>
                    <ul>
                        <li class="rank-num1">NO.{$i}</li>
                        <li style="text-align: center; width: 13%;"><a href="{:U('rankdetail', array('groupid'=>$vo['id'], 'startTime'=>I('startTime'), 'endTime'=>I('endTime')))}"><span class="rank_head1" style="background-image: url('{$vo.avatar|default='__TMPL__Public/assets/images/0.png'}');"></span></a></li>
                        <li class="ming">
                            <if condition="$grouptype eq 0">
                                <div class="ming-n">{$vo.nick_name}</div>
                            </if>
                            <if condition="$grouptype eq 1">
                                <div class="ming-s" style="height: 1rem;line-height: 1rem;">{$vo.nick_name}[{$vo.num|default=0}步]</div>
                            </if>
                            <div class="ming-s">{$vo.school|default='暂无'}</div>
                        </li>
                        <if condition="$grouptype eq 0">
                        <li class="count1">步数:{$vo.num}</li>
                        </if>
                        <if condition="$grouptype eq 1">
                            <li class="count1">平均:{$vo.avgNum}</li>
                        </if>
                        <eq name="i" value="1">
                            <li class="pai"><img src="__TMPL__Public/assets/images/1.png"></li>
                        </eq>
                        <eq name="i" value="2">
                            <li class="pai"><img src="__TMPL__Public/assets/images/2.png"></li>
                        </eq>
                        <eq name="i" value="3">
                            <li class="pai"><img src="__TMPL__Public/assets/images/3.png"></li>
                        </eq>
                    </ul>
                </volist>
            </div>
            <ul class="rank-my">
                <li class="rank-num1">NO.{$user['rank']|default='无'}</li>
                <li style="text-align: center; width: 13%;"><span class="rank_head1" style="background-image: url('{$user.avatar|default='__TMPL__Public/assets/images/0.png'}');"></span></li>
                <li class="ming" style="line-height: 2rem; font-size: 0.3rem;">
                    <if condition="$grouptype eq 0">当前自己排名<else/>当前联盟排名</if>
                </li>
                <li class="count1">步数：{$user['num']|default='0'}</li>
            </ul>
        </div>
    </div>
    <tc_include file="Public:footer" />
    <div id="loginmodal" style="display:none;">
            <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/rank', array('type'=>1,'grouptype'=>$grouptype))}"><input type="button" class="flatbtn-blu hidemodal" value="昨日记录"></a></div>
            <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/rank', array('type'=>2,'grouptype'=>$grouptype))}"><input type="button" class="flatbtn-blu hidemodal" value="上周记录"></a></div>
            <div class="center" style="margin: 0.5rem 0;"><a href="{:U('Index/rank', array('type'=>3,'grouptype'=>$grouptype))}"><input type="button" class="flatbtn-blu hidemodal" value="上月记录"></a></div>
        <form id="loginform" name="loginform" method="post" action="{:U('Index/rank')}" onsubmit="return check(this)">
            <input type="hidden" name="type" id="type" value="4">
            <input type="hidden" name="grouptype" id="grouptype" value="{$grouptype}">
            <div class="center" style="color: #18abe1;">选择时间段</div>
            <div class="center" style="margin: 0.5rem 0;padding-right: 2rem;width: 13rem;"><span style="color: #18abe1;">开始时间：</span><span><input type="date" name="startTime" id="startTime" style="height: 1rem;"></span></div>
            <div class="center" style="margin: 0.5rem 0;padding-right: 2rem;width: 13rem;"><span style="color: #18abe1;">结束时间：</span><span><input type="date" name="endTime" id="endTime" style="height: 1rem;"></span></div>
            <div class="center" style="margin: 0.5rem 0;"><input type="submit" class="flatbtn-blu hidemodal" value="搜索">
                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="button" class="flatbtn-blu close" value="取消"/></div>
        </form>
    </div>
</div>
<script>
    $(function(){
        $('.modaltrigger').leanModal({ top: 110, overlay: 0.45});
        document.getElementById('startTime').valueAsDate = new Date();
        document.getElementById('endTime').valueAsDate = new Date();
        $(".rank-top ul li").click(function(){
            $(this).addClass("blue").siblings().removeClass("blue");
        });
        $(".rank-content-nav ul li").click(function(){
            $(this).addClass("gray_rank").siblings().removeClass("gray_rank");
        });
        $('.close').click(function(){
            $(this).parents("#loginmodal").hide();
            $("#lean_overlay").css('display','none');
        });
    });
    function check(form) {
        if(form.startTime.value=='') {
            alert("请输入开始时间!");
            form.startTime.focus();
            return false;
        }
        if(form.endTime.value=='') {
            alert("请输入结束时间!");
            form.endTime.focus();
            return false;
        }
        if(form.startTime.value > form.endTime.value){
            alert("开始时间不能晚于结束时间!");
            form.endTime.focus();
            return false;
        }
    }
</script>
<script src="__TMPL__Public/assets/js/jquery-1.9.1.min.js"></script>
<script src="__TMPL__Public/assets/js/jquery.leanModal.min.js"></script>
</body>
</html>